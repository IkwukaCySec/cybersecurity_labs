import sys
import string

def extract_printable_strings(data, min_length=5):
    current = ""
    results = []
    for byte in data:
        char = chr(byte)
        if char in string.printable and char not in '\r\n\t':
            current += char
        else:
            if len(current) >= min_length:
                results.append(current)
            current = ""
    if len(current) >= min_length:
        results.append(current)
    return results

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python extract_strings.py <binary_file>")
        sys.exit(1)
    
    filename = sys.argv[1]
    try:
        with open(filename, "rb") as f:
            data = f.read()
        
        print("[*] Extracting printable strings (min length 5)...\n")
        strings = extract_printable_strings(data)
        for s in strings:
            if "THM{" in s:
                print(f"[!] FLAG FOUND: {s}")
            elif "HopHelper" in s or "Run" in s:
                print(f"[i] Interesting: {s}")
            # Uncomment below to print all (caution: very long output)
            # print(s)
        
        print(f"\n[+] Total strings extracted: {len(strings)}")
    except Exception as e:
        print(f"[-] Error: {e}")
