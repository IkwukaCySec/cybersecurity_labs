import matplotlib.pyplot as plt
import numpy as np

# Simulate race timing
threads = 20
timeline = np.random.uniform(0, 2, threads)
events = ['Read Stock', 'Check >0', 'Decrement', 'Commit']

plt.figure(figsize=(10, 6))
for i, time in enumerate(timeline):
    plt.hlines(i, time, time + 1.5, color='red')
    plt.text(time + 0.75, i, f'Thread {i+1}', va='center')

plt.yticks(range(threads))
plt.xlabel('Time (s)')
plt.title('Race Condition Timing Visualization')
plt.grid(True, axis='x')
plt.tight_layout()
plt.savefig('../screenshots/race_graph.png')
print("[+] Graph saved")
