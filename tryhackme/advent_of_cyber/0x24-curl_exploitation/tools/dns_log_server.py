from scapy.all import *

def dns_handler(pkt):
    if pkt.haslayer(DNS) and pkt.getlayer(DNS).qr == 0:
        print(f"[+] DNS Query: {pkt.getlayer(DNSQR).qname.decode()}")

sniff(filter="port 53", prn=dns_handler)
