#!/usr/bin/env python3
# Extract Interesting Strings from HTA/JS

import re
import sys

def extract_strings(content):
    # URLs
    urls = re.findall(r'https?://[^\s"\'<>]+', content)
    # Potential commands
    cmds = re.findall(r'(powershell|cmd|wscript|mshta)[^"\']*', content, re.IGNORECASE)
    # Suspicious functions
    funcs = re.findall(r'(eval|exec|ActiveXObject|WScript\.Shell)', content)
    
    return {"urls": urls, "commands": cmds, "functions": funcs}

if __name__ == "__main__":
    with open(sys.argv[1], 'r', encoding='utf-16le', errors='ignore') as f:
        content = f.read()
    
    results = extract_strings(content)
    print("Extracted IOCs:")
    for key, values in results.items():
        if values:
            print(f"\n{key.upper()}:")
            for v in set(values):
                print(f"  - {v}")
