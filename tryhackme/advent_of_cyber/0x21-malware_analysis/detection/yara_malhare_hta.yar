rule Malhare_HTA_DeveloperSurvey_2025
{
    meta:
        description = "Detects Malhare HTA dropper - Developer Survey Lure (AoC 2025 Day 21)"
        author = "IkwukaCySec"
        date = "31-12-2025"
        classification = "Troj/HTA-Mal"

    strings:
        $hta_tag = "<hta:application" nocase
        $title1 = "Best Festival Company Developer Survey" wide ascii
        $title2 = "Developer Salary Survey 2025" wide ascii
        $eval = "eval(" nocase
        $fromchar = "String.fromCharCode" nocase
        $mshta = "mshta.exe" nocase
        $powershell = "powershell.exe" nocase

    condition:
        $hta_tag in (0..1024) and
        any of ($title*) and
        3 of ($eval, $fromchar, $mshta, $powershell)
}
