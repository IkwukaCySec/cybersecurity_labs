input { beats { port => 5044 } }  # Filebeat sends here, but for simplicity use direct

filter {
  if [path] =~ "auth.log" {
    grok {
      match => { "message" => "%{SYSLOGTIMESTAMP:timestamp} %{SYSLOGHOST:hostname} sshd\[%{NUMBER:pid}\]: Failed password for %{DATA:user} from %{IP:src_ip}" }
    }
    date { match => ["timestamp", "MMM  d HH:mm:ss", "MMM dd HH:mm:ss"] }
  }
}

output { elasticsearch { hosts => ["elasticsearch:9200"] index => "ssh-logs-%{+YYYY.MM.dd}" } }
