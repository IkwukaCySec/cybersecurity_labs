# Day 2 Assignment – Remediation Plan

**Date:** February 09, 2026  
**Author:** Ikwuka Okoye
**Target:** Metasploitable 2 VM  
**Exploited Vulnerability:** vsftpd 2.3.4 Backdoor (CVE-2011-2523)  
**CVSS Score:** 10.0 (Critical) – from Nmap vulners scan  
**Impact:** Allows unauthenticated remote root shell execution via a malicious smiley-face `(:)` in the FTP username field.

## Executive Summary

During Day 2 assessment, a Nikto/Nmap scan of Metasploitable 2 identified multiple high-severity vulnerabilities. The vsftpd 2.3.4 backdoor was successfully exploited using Metasploit to gain root access. This document outlines immediate mitigation, long-term hardening, and verification steps to prevent recurrence.

## Vulnerability Details

- **Service:** vsftpd 2.3.4 (FTP server)
- **CVE:** CVE-2011-2523
- **Discovery:** Nmap --script vulners identified the vulnerable version; Nikto flagged FTP-related misconfigurations.
- **Exploitation:** Metasploit module `exploit/unix/ftp/vsftpd_234_backdoor` → reverse shell as root.

## Remediation Steps

### 1. Immediate Mitigation (Remove the Vulnerability)
- Uninstall the vulnerable vsftpd package:
```
sudo apt remove --purge vsftpd -y
sudo apt autoremove -y
```

- Or disable the service without removal (if needed temporarily):
```
sudo systemctl disable vsftpd
sudo systemctl stop vsftpd
```

- Comment out vsftpd line in `/etc/inetd.conf` (or equivalent) and restart inetd/xinetd.

### 2. Patching & Secure Replacement
- Replace with a modern, patched FTP/SFTP solution:
- Use **SFTP** (via OpenSSH) instead of plain FTP
- Or install updated vsftpd (3.x+ series) if FTP is required:
```
sudo apt install vsftpd   # ensure latest version from repos
```

- Apply all system updates:
```
sudo apt update && sudo apt full-upgrade -y
```

### 3. System Hardening
- **Firewall rules** — block FTP port unless absolutely needed:
```
sudo ufw deny 21
sudo ufw reload
```

- **Disable unnecessary services** — principle of least privilege:
```
sudo systemctl disable --now <unneeded-service>
```

- Remove default/test accounts (e.g., msfadmin) or change passwords.
- Enable logging and monitoring for FTP attempts.

### 4. Detection & Monitoring
- Deploy intrusion detection (e.g., Snort/Suricata) to alert on anomalous FTP traffic.
- Monitor logs: `/var/log/vsftpd.log`, `/var/log/auth.log`
- Implement regular vulnerability scanning (Nikto, Nmap, or full OpenVAS when setup completes).

### 5. Verification
- Re-run Nmap vulners scan → CVE-2011-2523 should no longer appear.
- Attempt exploit again → should fail (no backdoor response).
- Confirm service is disabled/removed: `systemctl status vsftpd` → inactive or not found.

## Summary Risk Reduction

Implementing these steps reduces exploitability from **Critical (CVSS 10.0)** to **None** for this specific vulnerability. Combined with regular patching and scanning, the overall attack surface decreases significantly.

**Resources Referenced:**
- CVE-2011-2523 details: https://nvd.nist.gov/vuln/detail/CVE-2011-2523
- vsftpd hardening guide: Official vsftpd documentation & OWASP recommendations

This plan was developed after successful exploitation demonstration in a controlled lab environment.
